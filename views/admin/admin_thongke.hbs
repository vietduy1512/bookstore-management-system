<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="">
<!--<![endif]-->

<head>
    {{>admin_head}}
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

</head>

<body>

    {{>admin_dashboard_leftpanel}}

    <!-- Right Panel -->

    <div id="right-panel" class="right-panel">

        {{>admin_dashboard_header}}

        <div class="breadcrumbs">
            <div class="col-sm-4">
                <div class="page-header float-left">
                    <div class="page-title">
                        <h1>Dashboard</h1>
                    </div>
                </div>
            </div>
            <div class="col-sm-8">
                <div class="page-header float-right">
                    <div class="page-title">
                        <ol class="breadcrumb text-right">
                            <li class="active">Dashboard</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>

        <div class="container">
            <ul class="nav nav-tabs">
                <li class="nav-item">
                    <a class="nav-link active" data-toggle="tab" href="#year">Năm</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#month">Tháng</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#date">Ngày</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#week">Tuần</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#quarter">Quý</a>
                </li>
            </ul>
        </div>
        <div class="tab-content">
            <div class="tab-pane container active" id="month">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header">
                                <strong class="card-title">Doanh Số Theo Tháng</strong>
                            </div>
                            <div class="card-body">
                                <table id="month-table" class="table table-striped table-bordered">
                                    <thead>
                                        <tr>
                                            <th style="display:none"></th>
                                            <th>Tháng</th>
                                            <th>Số Đơn Hàng</th>
                                            <th>Số Tiền (VNĐ)</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {{#each tkTimes.Month}}
                                        <tr id='{{Month}}-m'>
                                            <td style="display:none">{{Number}}</td>
                                            <td>{{Month}}</td>
                                            <td>{{SoLuong}}</td>
                                            <td>{{SoTien}}</td>
                                        </tr>
                                        {{/each}}
                                    </tbody>
                                </table>
                            </div>
                            <div class="p-4 mt-1" id="month_chart"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tab-pane container fade" id="year">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header">
                                <strong class="card-title">Doanh Số Theo Năm</strong>
                            </div>
                            <div class="card-body">
                                <table id="year-table" class="table table-striped table-bordered">
                                    <thead>
                                        <tr>
                                            <th style="display:none"></th>
                                            <th>Năm</th>
                                            <th>Số Đơn Hàng</th>
                                            <th>Số Tiền (VNĐ)</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {{#each tkTimes.Year}}
                                        <tr id='{{Year}}-y'>
                                            <td style="display:none">{{Number}}</td>
                                            <td>{{Year}}</td>
                                            <td>{{SoLuong}}</td>
                                            <td>{{SoTien}}</td>
                                        </tr>
                                        {{/each}}
                                    </tbody>
                                </table>
                            </div>
                            <div class="p-4 mt-1" id="year_chart"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tab-pane container fade" id="date">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header">
                                <strong class="card-title">Doanh Số Theo Ngày</strong>
                            </div>
                            <div class="card-body">
                                <table id="date-table" class="table table-striped table-bordered">
                                    <thead>
                                        <tr>
                                            <th style="display:none"></th>
                                            <th>Ngày</th>
                                            <th>Số Đơn Hàng</th>
                                            <th>Số Tiền (VNĐ)</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {{#each tkTimes.Date}}
                                        <tr id='{{Date}}-d'>
                                            <td style="display:none">{{Number}}</td>
                                            <td>{{Date}}</td>
                                            <td>{{SoLuong}}</td>
                                            <td>{{SoTien}}</td>
                                        </tr>
                                        {{/each}}
                                    </tbody>
                                </table>
                                <div class="p-4 mt-1" id="date_chart"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tab-pane container fade" id="week">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header">
                                <strong class="card-title">Doanh Số Theo Tuần</strong>
                            </div>
                            <div class="card-body">
                                <table id="week-table" class="table table-striped table-bordered">
                                    <thead>
                                        <tr>
                                            <th style="display:none"></th>
                                            <th>Tuần</th>
                                            <th>Số Đơn Hàng</th>
                                            <th>Số Tiền (VNĐ)</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {{#each tkTimes.Week}}
                                        <tr id='{{Week}}-w'>
                                            <td style="display:none">{{Number}}</td>
                                            <td>{{Week}}</td>
                                            <td>{{SoLuong}}</td>
                                            <td>{{SoTien}}</td>
                                        </tr>
                                        {{/each}}
                                    </tbody>
                                </table>
                            </div>
                            <div class="p-4 mt-1" id="week_chart"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tab-pane container fade" id="quarter">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header">
                                <strong class="card-title">Doanh Số Theo Quý</strong>
                            </div>
                            <div class="card-body">
                                <table id="quater-table" class="table table-striped table-bordered">
                                    <thead>
                                        <tr>
                                            <th style="display:none"></th>
                                            <th>Quý</th>
                                            <th>Số Đơn Hàng</th>
                                            <th>Số Tiền (VNĐ)</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {{#each tkTimes.Quarter}}
                                        <tr id='{{Quarter}}-q'>
                                            <td style="display:none">{{Number}}</td>
                                            <td>{{Quarter}}</td>
                                            <td>{{SoLuong}}</td>
                                            <td>{{SoTien}}</td>
                                        </tr>
                                        {{/each}}
                                    </tbody>
                                </table>
                            </div>
                            <div class="p-4 mt-1" id="quater_chart"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


    </div>
    <!-- /#right-panel -->

    <!-- Right Panel -->

    {{>admin_script}}

    <script type="text/javascript">
        $(document).ready(function () {
            $('#month-table').DataTable({
                "order": [[0, 'desc']]
            });
            $('#year-table').DataTable({
                "order": [[0, 'desc']]
            });
            $('#date-table').DataTable({
                "order": [[0, 'desc']]
            });
            $('#week-table').DataTable({
                "order": [[0, 'desc']]
            });
            $('#quater-table').DataTable({
                "order": [[0, 'desc']]
            });

        });

        var month = "{{Month}}";
        month = month.replace(/&quot;/g, '"');
        monthArr = (JSON.parse(month))

        var year = "{{Year}}";
        year = year.replace(/&quot;/g, '"');
        yearArr = (JSON.parse(year))

        var date = "{{Date}}";
        date = date.replace(/&quot;/g, '"');
        dateArr = (JSON.parse(date))
        console.log(date);

        var Week = "{{Week}}";
        Week = Week.replace(/&quot;/g, '"');
        weekArr = (JSON.parse(Week))

        var quarter = "{{Quarter}}";
        quarter = quarter.replace(/&quot;/g, '"');
        quarterArr = (JSON.parse(quarter))

        google.charts.load('current', { 'packages': ['line', 'corechart'] });

        google.charts.setOnLoadCallback(function () {
            drawChart('month_chart', 'Số Lượng Đơn Hàng Và Số Tiền Theo Tháng', 'Tháng', monthArr);
        });

        $("a[href='#month']").on('shown.bs.tab', function (e) {
            google.charts.setOnLoadCallback(function () {
                drawChart('month_chart', 'Số Lượng Đơn Hàng Và Số Tiền Theo Tháng', 'Tháng', monthArr);
            });
        });
        $("a[href='#year']").on('shown.bs.tab', function (e) {
            google.charts.setOnLoadCallback(function () {
                drawChart('year_chart', 'Số Lượng Đơn Hàng Và Số Tiền Theo Năm', 'Năm', yearArr)
            });
        });
        $("a[href='#date']").on('shown.bs.tab', function (e) {
            google.charts.setOnLoadCallback(function () {
                console.log(date)
                drawChart('date_chart', 'Số Lượng Đơn Hàng Và Số Tiền Theo Ngày', 'Ngày', dateArr)
            });
        });
        $("a[href='#week']").on('shown.bs.tab', function (e) {
            google.charts.setOnLoadCallback(function () {
                drawChart('week_chart', 'Số Lượng Đơn Hàng Và Số Tiền Theo Tuần', 'Tuần', weekArr)
            });
        });
        $("a[href='#quarter']").on('shown.bs.tab', function (e) {
            google.charts.setOnLoadCallback(function () {
                drawChart('quater_chart', 'Số Lượng Đơn Hàng Và Số Tiền Theo Quý', 'Quý', quarterArr)
            });
        });



        function drawChart(chartdiv, header, collunm, dataArr) {
            var chartDiv = document.getElementById(chartdiv);
            var data = new google.visualization.DataTable();
            data.addColumn('string', collunm);
            data.addColumn('number', "Số Lượng Đơn Hàng");
            data.addColumn('number', "Số Tiền");
            data.addRows(dataArr);

            var materialOptions = {
                chart: {
                    title: header
                },
                width: $('#'+chartdiv).width(),
                height: 400,
                series: {
                    // Gives each series an axis name that matches the Y-axis below.
                    0: { axis: 'Số Đơn Hàng' },
                    1: { axis: 'Số Tiền' }
                },
                axes: {
                    // Adds labels to each axis; they don't have to match the axis names.
                    y: {
                        Temps: { label: 'Số Đơn Hàng' },
                        Daylight: { label: 'Số Tiền (VNĐ)' }
                    }
                }
            };
            function drawMaterialChart() {
                var materialChart = new google.charts.Line(chartDiv);
                materialChart.draw(data, materialOptions);
            }
            drawMaterialChart();
        }

        function hide_element(_id) {
            var x = document.getElementById(_id);
            alert(_id)
            if (x.style.display !== "none") {
                x.style.display = "none";
            }
        }
    </script>

</body>

</html>